---
import { getCollection } from "astro:content";
import CommonHead from "../../components/common/CommonHead.astro";
import CommonHeader from "../../components/common/CommonHeader.astro";
import Footer from "../../components/footer/Footer.astro";
import Next from "../../components/common/Next.astro";
import PageTitle from "../../components/common/PageTitle.astro";
import Search from "../../components/patrician-publications/Search.astro";
import Feature from "../../components/patrician-publications/Feature.astro";
import PatricianPublicationCard from "../../components/patrician-publications/PatricianPublicationCard.astro";

import "@fontsource/space-grotesk/400.css";
import "@fontsource/space-grotesk/700.css";
import "@fontsource/space-mono/400.css";
import MobileNavButton from "../../components/common/MobileNavButton.astro";
import RemoteImage from "../../components/common/RemoteImage.astro";
import PrimaryCTA from "../../components/common/PrimaryCTA.astro";
import PostCardDesc from "../../components/patrician-publications/PostCardDesc.astro";
import Loader from "../../components/common/Loader.astro";
import { get_api_route } from "../../config/global";

// get posts
const allPosts = await getCollection("posts");
// filter featured posts
const featured = allPosts.filter((p) => p.data.tags.includes("feat"));
// filter normal posts
var other = allPosts.filter((p) => !p.data.tags.includes("feat"));

// incase author forgot to remove old `feat` indicator from tags
// we combine them with other posts
if (featured.length > 1) {
    other = [featured.slice(1), other].flat();
}

const nexts = [
    ["Home.", "/"],
    ["Our Spirituality.", "/our-spirituality"],
    ["Academics.", "/academics"],
    ["Sports.", "/sports"],
    ["Socities.", "socities"]
];
---

<html lang="en">
<CommonHead title="Patrician Publications | SPC Media Unit | 175 years" />

<body x-data="{open:false}" class="cursor-default bg-spc-dark text-spc-light font-sans">
<CommonHeader title="Patrician<br/>Publications" now="Blog" />

<PageTitle title="Patrician Publications" />

<Search />

<main>
    <section class="my-10 md:px-12 xl:px-96"
             hx-get={get_api_route("read-blog-feat")} hx-trigger="load" hx-swap="innerHTML">
        <Loader />
    </section>

    <section
        class="my-16 px-6 md:px-12 xl:px-96 md:grid md:grid-cols-2 md:gap-4"
        hx-get={get_api_route("read-blog-list")} hx-trigger="load delay:400ms" hx-swap="innerHTML"
    >
        <Loader />
    </section>
</main>

<Next nexts={nexts} />
<Footer />
<MobileNavButton />
<script
    is:inline
    src="https://unpkg.com/htmx.org@1.9.11"
    integrity="sha384-0gxUXCCR8yv9FM2b+U3FDbsKthCI66oH5IA9fHppQq9DDMHuMauqq1ZHBpJxQ0J0"
    crossorigin="anonymous"></script>
</body>
</html>
